<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pokédex QR Code Scanner</title>
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.js"></script>
    <style>
      body {
        font-family: 'Arial', sans-serif;
        background: url('https://example.com/pokedex-background.jpg') no-repeat center center fixed;
        background-size: cover;
        color: #333;
        text-align: center;
      }
      h1 {
        color: #ffcc00;
        font-size: 48px;
        text-shadow: 3px 3px 10px rgba(0, 0, 0, 0.7);
        font-family: 'Pokemon', sans-serif;
        margin-top: 20px;
      }
      #canvas {
        border: 5px solid #ffcc00;
        border-radius: 15px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        margin-top: 30px;
      }
      #output {
        margin-top: 30px;
        font-size: 26px;
        font-weight: bold;
        color: #ff3333;
        text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.7);
        background-color: rgba(255, 255, 255, 0.8);
        padding: 10px;
        border-radius: 10px;
        max-width: 80%;
        margin-left: auto;
        margin-right: auto;
      }
      #output::before {
        content: 'Pokémon Detected: ';
      }
      .pokemon-logo {
        width: 250px;
        margin-top: 20px;
      }
      .poke-ball {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        border: 8px solid red;
        margin: 20px 0;
      }
      .poke-ball:before {
        content: '';
        display: block;
        width: 100%;
        height: 50%;
        background-color: #fff;
        border-bottom: 8px solid red;
      }
      .poke-ball:after {
        content: '';
        display: block;
        width: 10px;
        height: 10px;
        background-color: black;
        border-radius: 50%;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      }
    </style>
  </head>
  <body>
    <h1>Pokédex QR Code Scanner</h1>
    <div class="poke-ball"></div>
    <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/25.png" alt="Pokémon Logo" class="pokemon-logo" />
    <video id="video" width="640" height="480" style="display: none"></video>
    <canvas id="canvas" width="640" height="480"></canvas>
    <div id="output"></div>

    <script>
      const video = document.createElement("video");
      const canvasElement = document.getElementById("canvas");
      const canvas = canvasElement.getContext("2d");
      const output = document.getElementById("output");

      // Pokémon background music
      const audio = new Audio("https://www.pokemon.com/us/pokemon-episodes/sounds/pokemon-theme-song.mp3");

      navigator.mediaDevices
        .getUserMedia({ video: { facingMode: "environment" } })
        .then(function (stream) {
          video.srcObject = stream;
          video.setAttribute("playsinline", true); // required to tell iOS safari we don't want fullscreen
          video.play();
          requestAnimationFrame(tick);
        });

      function tick() {
        if (video.readyState === video.HAVE_ENOUGH_DATA) {
          canvasElement.hidden = false;
          canvasElement.height = video.videoHeight;
          canvasElement.width = video.videoWidth;
          canvas.drawImage(
            video,
            0,
            0,
            canvasElement.width,
            canvasElement.height
          );
          const imageData = canvas.getImageData(
            0,
            0,
            canvasElement.width,
            canvasElement.height
          );
          const code = jsQR(imageData.data, imageData.width, imageData.height, {
            inversionAttempts: "dontInvert",
          });

          // Check if a QR code was detected and display Pokémon data
          if (code) {
            output.innerText = `Pokémon Detected: ${code.data}`;
            console.log("QR Code detected:", code.data);
            // Play Pokémon theme music when a QR code is detected
            audio.play();
          } else {
            console.log("No QR code detected.");
          }
        }
        requestAnimationFrame(tick);
      }
    </script>
  </body>
</html>
